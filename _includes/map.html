<div id="map" style="width:700px;height:700px;"></div>

<!-- utils -->
<script>
  function getValues(obj) {
    return Object.entries(obj).map(o => o[1])
  }
</script>

<!-- data -->
<script>
    window.data = {
    "latitude": parseInt("{{ include.latitude }}"),
    "longitude": parseInt("{{ include.longitude }}"),
    "zoom": 9,
  };


  window.geoData = {
    "florence": {
      "lat": 43.874316,
      "lng": 11.289719
    },
    "pisa": {
      "lat": 43.722627,
      "lng": 10.401901
    },
    "cinqueterre": {
      "lat": 44.127333,
      "lng": 9.714177
    }
    "siena": {
      "lat":43.320749,
      "lng": 11.332799
    },
    "ferraryMuseum": {
      "lat": 44.529728,
      "lng": 10.861362
    },
    "Elba": {
      "lat": 42.778161,
      "lng": 10.193319
    }
  }

  window.destinationMarkers = [
    {
      loc: window.geoData.florence,
      title: "Florecne",
      label: "C"
    },
    {
      loc: window.geoData.pisa,
      title: "Pisa",
      label: "C"
    },
    {
      loc: window.geoData.cinqueterre,
      title: "Cinque Terre",
      label: "C"
    },
    {
      loc: window.geoData.siena,
      title: "Siena",
      label: "C"
    },
    {
      loc: window.geoData.ferraryMuseum,
      title: "Ferrary Museum",
      label: "M"
    },
    {
      loc: window.geoData.ferraryMuseum,
      title: "Elba",
      label: "I"
    }
  ]

  window.locations = getValues(window.geoData)
</script>

<script type="text/javascript">
  function addMarker(marker, map) {
    console.log("rendering marker: loc="+ marker.loc.lat, "ln="+ marker.loc.lng);
    return new google.maps.Marker({
      map: map,
      position: marker.loc,
      label: marker.label
    });
  }
</script>

<script type="text/javascript">
    function initMap() {
    var options = {
      scrollwheel: true,
      draggable: true,
      panControl: true,
      disableDefaultUI: true,
      zoom: window.data.zoom,
      maxZoom: window.data.zoom,
      minZoom: window.data.zoom,
      center: window.geoData.pisa,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById('map'), options);

    // display destinations
    window.destinationMarkers.forEach(e => addMarker(e, map))

    google.maps.event.addDomListener(window, 'resize', function() {
      map.setCenter(options.center);
    });
  }
</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key={{site.google-maps-api-key}}&amp;callback=initMap"></script>
